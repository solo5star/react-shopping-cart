import{j as l,c,d as u,e as p}from"./http-8318f289.js";const d=[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,307,308];class m{constructor(t){this.responsePromise=t()}assertStatusCode(t,e){return(Array.isArray(e)?e:[e]).includes(t.statusCode)}async accept(t){const e=await this.responsePromise;return this.assertStatusCode(e,t)?e:null}async acceptOrThrow(t){const e=await this.responsePromise;if(!this.assertStatusCode(e,t))throw new Error(`Server responses with status code ${e.statusCode}`);return e}async acceptOkOrThrow(){return this.acceptOrThrow(d)}}class S{constructor(t,...e){this.internalQueryParams=null,this.path=t,this.internalParams=e}queryParams(t){return this.internalQueryParams=t,this}toString(){const t=[...this.internalParams],e=this.path.split("/").map(a=>a.startsWith(":")?t.shift():a).join("/"),s=Object.keys(this.internalQueryParams??{}).length===0?"":`?${new URLSearchParams(this.internalQueryParams??{}).toString()}`;return e+s}}class f{constructor(t={}){this.options=t}getUrl(t){return l(this.options.baseUrl??"",t)}async parseResponseData(t){try{return await t.json()}catch{return null}}fetch(t,e,s){return new m(async()=>{const a=await fetch(this.getUrl(e.toString()),{method:t,...s});return{statusCode:a.status,data:await this.parseResponseData(a),headers:Object.fromEntries(a.headers.entries())}})}get(t){return this.fetch("GET",t)}post(t,e){return this.fetch("POST",t,{headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}patch(t,e){return this.fetch("PATCH",t,{headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}delete(t){return this.fetch("DELETE",t)}path(t,...e){return new S(t,...e)}}const i=new f({baseUrl:"/react-shopping-cart/storybook"}),P=i.path.bind(i),y=r=>({setSelf:t,onSet:e})=>{const s=localStorage.getItem(r);s!==null&&t(JSON.parse(s)),e((a,O,h)=>{if(h){localStorage.removeItem(r);return}localStorage.setItem(r,JSON.stringify(a))})},n=c({key:"cartItemEntitiesState",default:i.get("/cart-items").acceptOrThrow(200).then(r=>r.data)}),o=c({key:"unselectedForOrdersState",default:[],effects:[y("unselectedForOrders")]}),w=u({key:"cartItemsState",get:({get:r})=>{const t=r(n),e=r(o);return t.map(s=>({...s,unselectedForOrder:e.includes(s.id)}))},set:({set:r,reset:t},e)=>{if(e instanceof p){t(n),t(o);return}r(n,e),r(o,e.filter(s=>s.unselectedForOrder).map(s=>s.id))}});export{i as a,w as c,P as p};
//# sourceMappingURL=cartItemsState-c47f54f4.js.map
